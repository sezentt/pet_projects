# Binary Classification with a Bank Dataset

**Цель проекта**: Построить модель бинарной классификации, предсказывающую, **подпишется ли клиент на срочный депозит** (target `y`: 0/1), с упором на высокое качество по метрике **ROC AUC**.

**Соревнование**: https://www.kaggle.com/competitions/playground-series-s5e8/overview

## Описание задачи
Задача основана на маркетинговых кампаниях банка: по информации о клиенте и параметрам последнего контакта нужно предсказать вероятность отклика.

Проект включает:
* базовый EDA и проверку сдвига между `train` и `test`;
* корреляционный анализ и выявление мультиколлинеарности;
* подготовку данных через единый sklearn-пайплайн (без утечек);
* инженерные признаки;
* подбор гиперпараметров (CV) и финальное обучение;
* формирование файла `submission.csv` (`id`, `y_proba`).

## Описание данных
**Размеры:** `train: 750000×18`, `test: 250000×17`. Пропусков нет.

**Признаки:**

* **Числовые:**
  `age` — возраст;
  `balance` — среднегодовой баланс (EUR);
  `day` — день месяца последнего контакта (1–31);
  `duration` — длительность последнего контакта (сек);
  `campaign` — число контактов в текущей кампании;
  `pdays` — дней с момента предыдущего контакта (−1 = не контактировали);
  `previous` — число контактов до текущей кампании.
* **Категориальные:**
  `job`, `marital`, `education`, `default`, `housing`, `loan`, `contact`, `month`, `poutcome`.
* **Целевая переменная:** `y` — подписка на депозит (0/1).
* **Служебный идентификатор:** `id` (не используется в обучении, нужен для сабмита).

**Особенности и решения:**

* Сильная зависимость `pdays ↔ previous` → исключён `previous`.
* Разложение `pdays` на:
  `was_contacted = (pdays != -1)` и `pdays_pos = max(pdays, 0)`.
* `day` и `campaign` рассматриваются как **категориальные**.
* Инженерия признаков:
  `balance_log_signed = sign(balance)*log1p(|balance|)`;
  `duration_log = log1p(duration)`;
  квантильные бины `duration_bin`;
  возрастные бины `age_bin`;
  `campaign_cap = min(campaign, 6)`;
  циклические кодировки `month_sin/cos`, `day_sin/cos`.

## Используемые библиотеки

* **Python:** 3.10+
* **Data/EDA:** `pandas`, `numpy`, `matplotlib`, `seaborn`, `phik`, `scipy`
* **ML & Pipeline:** `scikit-learn` (Pipeline, ColumnTransformer, OneHotEncoder, StratifiedKFold, GridSearchCV)
* **Boosting:** `lightgbm` (GPU/CPU), (опционально `catboost` для сравнений)
* **Утилиты:** `tqdm` (прогресс)

> Итоговое решение реализовано как единый sklearn-пайплайн: предобработка → признакообразование → OHE/передача числовых → LGBM. Сабмит формируется как CSV с двумя колонками: `id`, `y`. Решение вошло в топ 30% всех решений.
